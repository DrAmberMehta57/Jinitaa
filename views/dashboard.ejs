<%- include('partials/header') %>

    <div class="bg-white rounded-lg shadow p-6">
        <div class="flex flex-col md:flex-row justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-clinic-blue">Patient Dashboard</h2>

            <form action="/admin/dashboard" method="GET" class="w-full md:w-auto mt-4 md:mt-0 flex">
                <input type="text" name="search" value="<%= search || '' %>" placeholder="Search by Name/ID/Phone..."
                    class="border-2 border-gray-300 rounded-l p-2 w-full md:w-64 focus:border-clinic-blue focus:outline-none">
                <button type="submit" class="bg-clinic-blue text-white px-4 rounded-r hover:bg-blue-700">Search</button>
            </form>
        </div>

        <div class="overflow-x-auto">
            <table class="min-w-full leading-normal">
                <thead>
                    <tr>
                        <th
                            class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Ref ID</th>
                        <th
                            class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Full Name</th>
                        <th
                            class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Date</th>
                        <th
                            class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (patients.length===0) { %>
                        <tr>
                            <td colspan="4" class="px-5 py-5 border-b border-gray-200 bg-white text-sm text-center">No
                                patients found.</td>
                        </tr>
                        <% } else { %>
                            <% patients.forEach(function(patient) { %>
                                <tr>
                                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                        <p class="text-gray-900 whitespace-no-wrap font-mono">
                                            <%= patient.ReferenceID %>
                                        </p>
                                    </td>
                                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                        <p class="text-gray-900 whitespace-no-wrap font-bold">
                                            <%= patient.FullName %>
                                        </p>
                                        <p class="text-gray-600 text-xs">
                                            <%= patient.Phone %>
                                        </p>
                                    </td>
                                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                        <p class="text-gray-900 whitespace-no-wrap">
                                            <%= new Date(patient.SubmissionDate).toLocaleDateString() %>
                                        </p>
                                    </td>
                                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                                        <a href="/admin/patient/<%= patient.PatientID %>"
                                            class="text-clinic-green hover:text-green-800 font-bold">View & Analyze</a>
                                    </td>
                                </tr>
                                <% }); %>
                                    <% } %>
                </tbody>
            </table>
        </div>
    </div>

    <%- include('partials/footer') %>